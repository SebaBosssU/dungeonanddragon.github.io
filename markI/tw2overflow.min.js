/*! tw2overflow.min.js@1.0.7 | Licence MIT */
!function(a,b){define("Lockr",function(a,b){"use strict";return b.prefix="",b._getPrefixedKey=function(a,b){return b=b||{},b.noPrefix?a:this.prefix+a},b.set=function(a,b,c){var d=this._getPrefixedKey(a,c);try{localStorage.setItem(d,JSON.stringify({data:b}))}catch(a){}},b.get=function(a,b,c){var d,e=this._getPrefixedKey(a,c);try{d=JSON.parse(localStorage.getItem(e))}catch(a){d=localStorage[e]?{data:localStorage.getItem(e)}:null}return null===d?b:"object"==typeof d&&void 0!==d.data?d.data:b},b}(a,{}))}(this),function(){var a,b,c,d=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(){this.translate=d(this.translate,this),this.data={values:{},contexts:[]},this.globalContext={}}return a.prototype.translate=function(a,b,c,d,e){var f,g,h,i;return null==e&&(e=this.globalContext),h=function(a){var b;return"function"===(b=typeof a)||"object"===b&&!!a},h(b)?(f=null,i=null,g=b,e=c||this.globalContext):"number"==typeof b?(f=null,i=b,g=c,e=d||this.globalContext):(f=b,"number"==typeof c?(i=c,g=d,e=e):(i=null,g=c,e=d||this.globalContext)),h(a)?(h(a.i18n)&&(a=a.i18n),this.translateHash(a,e)):this.translateText(a,i,g,e,f)},a.prototype.add=function(a){var b,c,d,e,f,g,h,i;if(null!=a.values){g=a.values;for(c in g)d=g[c],this.data.values[c]=d}if(null!=a.contexts){for(h=a.contexts,i=[],e=0,f=h.length;e<f;e++)b=h[e],i.push(this.data.contexts.push(b));return i}},a.prototype.setContext=function(a,b){return this.globalContext[a]=b},a.prototype.clearContext=function(a){return this.lobalContext[a]=null},a.prototype.reset=function(){return this.data={values:{},contexts:[]},this.globalContext={}},a.prototype.resetData=function(){return this.data={values:{},contexts:[]}},a.prototype.resetContext=function(){return this.globalContext={}},a.prototype.translateHash=function(a,b){var c,d;for(c in a)"string"==typeof(d=a[c])&&(a[c]=this.translateText(d,null,null,b));return a},a.prototype.translateText=function(a,b,c,d,e){var f,g;return null==d&&(d=this.globalContext),null==this.data?this.useOriginalText(e||a,b,c):(f=this.getContextData(this.data,d),null!=f&&(g=this.findTranslation(a,b,c,f.values,e)),null==g&&(g=this.findTranslation(a,b,c,this.data.values,e)),null==g?this.useOriginalText(e||a,b,c):g)},a.prototype.findTranslation=function(a,b,c,d){var e,f,g,h,i;if(null==(g=d[a]))return null;if(null==b){if("string"==typeof g)return this.applyFormatting(g,b,c)}else if(g instanceof Array||g.length)for(h=0,i=g.length;h<i;h++)if(f=g[h],(b>=f[0]||null===f[0])&&(b<=f[1]||null===f[1]))return e=this.applyFormatting(f[2].replace("-%n",String(-b)),b,c),this.applyFormatting(e.replace("%n",String(b)),b,c);return null},a.prototype.getContextData=function(a,b){var c,d,e,f,g,h,i,j;if(null==a.contexts)return null;for(i=a.contexts,g=0,h=i.length;g<h;g++){c=i[g],d=!0,j=c.matches;for(e in j)f=j[e],d=d&&f===b[e];if(d)return c}return null},a.prototype.useOriginalText=function(a,b,c){return null==b?this.applyFormatting(a,b,c):this.applyFormatting(a.replace("%n",String(b)),b,c)},a.prototype.applyFormatting=function(a,b,c){var d,e;for(d in c)e=new RegExp("%{"+d+"}","g"),a=a.replace(e,c[d]);return a},a}(),c=new a,b=c.translate,b.translator=c,b.create=function(c){var d;return d=new a,null!=c&&d.add(c),d.translate.create=b.create,d.translate},define("i18n",function(){return b})}.call(this),function(a){define("ejs",function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c||a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";function d(a,b){var d;if("/"==a.charAt(0))d=c.resolveInclude(a.replace(/^\/*/,""),b.root||"/",!0);else{if(!b.filename)throw new Error("`include` use relative path requires the 'filename' option.");d=c.resolveInclude(a,b.filename)}return d}function e(a,b){var d,e=a.filename,f=arguments.length>1;if(a.cache){if(!e)throw new Error("cache option requires a filename");if(d=c.cache.get(e))return d;f||(b=g(e).toString().replace(v,""))}else if(!f){if(!e)throw new Error("Internal EJS error: no file name or template provided");b=g(e).toString().replace(v,"")}return d=c.compile(b,a),a.cache&&c.cache.set(e,d),d}function f(a,b,c){var d;try{d=e(a)(b)}catch(a){return c(a)}return c(null,d)}function g(a){return c.fileLoader(a)}function h(a,b){var c=o.shallowCopy({},b);return c.filename=d(a,c),e(c)}function i(a,b){var c,e,f=o.shallowCopy({},b);c=d(a,f),e=g(c).toString().replace(v,""),f.filename=c;var h=new l(e,f);return h.generateSource(),{source:h.source,filename:c,template:e}}function j(a,b,c,d,e){var f=b.split("\n"),g=Math.max(d-3,0),h=Math.min(f.length,d+3),i=e(c),j=f.slice(g,h).map(function(a,b){var c=b+g+1;return(c==d?" >> ":"    ")+c+"| "+a}).join("\n");throw a.path=i,a.message=(i||"ejs")+":"+d+"\n"+j+"\n\n"+a.message,a}function k(a){return a.replace(/;(\s*$)/,"$1")}function l(a,b){b=b||{};var d={};this.templateText=a,this.mode=null,this.truncate=!1,this.currentLine=1,this.source="",this.dependencies=[],d.client=b.client||!1,d.escapeFunction=b.escape||o.escapeXML,d.compileDebug=!1!==b.compileDebug,d.debug=!!b.debug,d.filename=b.filename,d.delimiter=b.delimiter||c.delimiter||r,d.strict=b.strict||!1,d.context=b.context,d.cache=b.cache||!1,d.rmWhitespace=b.rmWhitespace,d.root=b.root,d.localsName=b.localsName||c.localsName||s,d.strict?d._with=!1:d._with=void 0===b._with||b._with,this.opts=d,this.regex=this.createRegex()}var m=a("fs"),n=a("path"),o=a("./utils"),p=!1,q=a("../package.json").version,r="%",s="locals",t=["delimiter","scope","context","debug","compileDebug","client","_with","rmWhitespace","strict","filename"],u=t.concat("cache"),v=/^\uFEFF/;c.cache=o.cache,c.fileLoader=m.readFileSync,c.localsName=s,c.resolveInclude=function(a,b,c){var d=n.dirname,e=n.extname,f=n.resolve,g=f(c?b:d(b),a);return e(a)||(g+=".ejs"),g},c.compile=function(a,b){var c;return b&&b.scope&&(p||(console.warn("`scope` option is deprecated and will be removed in EJS 3"),p=!0),b.context||(b.context=b.scope),delete b.scope),c=new l(a,b),c.compile()},c.render=function(a,b,c){var d=b||{},f=c||{};return 2==arguments.length&&o.shallowCopyFromList(f,d,t),e(f,a)(d)},c.renderFile=function(){var a,b=arguments[0],c=arguments[arguments.length-1],d={filename:b};return arguments.length>2?(a=arguments[1],3===arguments.length?a.settings&&a.settings["view options"]?o.shallowCopyFromList(d,a.settings["view options"],u):o.shallowCopyFromList(d,a,u):o.shallowCopy(d,arguments[2]),d.filename=b):a={},f(d,a,c)},c.clearCache=function(){c.cache.reset()},l.modes={EVAL:"eval",ESCAPED:"escaped",RAW:"raw",COMMENT:"comment",LITERAL:"literal"},l.prototype={createRegex:function(){var a="(<%%|%%>|<%=|<%-|<%_|<%#|<%|%>|-%>|_%>)",b=o.escapeRegExpChars(this.opts.delimiter);return a=a.replace(/%/g,b),new RegExp(a)},compile:function(){var a,b,c=this.opts,d="",e="",f=c.escapeFunction;this.source||(this.generateSource(),d+="  var __output = [], __append = __output.push.bind(__output);\n",!1!==c._with&&(d+="  with ("+c.localsName+" || {}) {\n",e+="  }\n"),e+='  return __output.join("");\n',this.source=d+this.source+e),a=c.compileDebug?"var __line = 1\n  , __lines = "+JSON.stringify(this.templateText)+"\n  , __filename = "+(c.filename?JSON.stringify(c.filename):"undefined")+";\ntry {\n"+this.source+"} catch (e) {\n  rethrow(e, __lines, __filename, __line, escapeFn);\n}\n":this.source,c.debug&&console.log(a),c.client&&(a="escapeFn = escapeFn || "+f.toString()+";\n"+a,c.compileDebug&&(a="rethrow = rethrow || "+j.toString()+";\n"+a)),c.strict&&(a='"use strict";\n'+a);try{b=new Function(c.localsName+", escapeFn, include, rethrow",a)}catch(a){throw a instanceof SyntaxError&&(c.filename&&(a.message+=" in "+c.filename),a.message+=" while compiling ejs\n\n",a.message+="If the above error is not helpful, you may want to try EJS-Lint:\n",a.message+="https://github.com/RyanZim/EJS-Lint"),a}if(c.client)return b.dependencies=this.dependencies,b;var g=function(a){var d=function(b,d){var e=o.shallowCopy({},a);return d&&(e=o.shallowCopy(e,d)),h(b,c)(e)};return b.apply(c.context,[a||{},f,d,j])};return g.dependencies=this.dependencies,g},generateSource:function(){this.opts.rmWhitespace&&(this.templateText=this.templateText.replace(/\r/g,"").replace(/^\s+|\s+$/gm,"")),this.templateText=this.templateText.replace(/[ \t]*<%_/gm,"<%_").replace(/_%>[ \t]*/gm,"_%>");var a=this,b=this.parseTemplateText(),d=this.opts.delimiter;b&&b.length&&b.forEach(function(e,f){var g,h,j,k,l,m;if(0===e.indexOf("<"+d)&&0!==e.indexOf("<"+d+d)&&(h=b[f+2])!=d+">"&&h!="-"+d+">"&&h!="_"+d+">")throw new Error('Could not find matching close tag for "'+e+'".');if((j=e.match(/^\s*include\s+(\S+)/))&&(g=b[f-1])&&(g=="<"+d||g=="<"+d+"-"||g=="<"+d+"_"))return k=o.shallowCopy({},a.opts),l=i(j[1],k),m=a.opts.compileDebug?"    ; (function(){\n      var __line = 1\n      , __lines = "+JSON.stringify(l.template)+"\n      , __filename = "+JSON.stringify(l.filename)+";\n      try {\n"+l.source+"      } catch (e) {\n        rethrow(e, __lines, __filename, __line);\n      }\n    ; }).call(this)\n":"    ; (function(){\n"+l.source+"    ; }).call(this)\n",a.source+=m,void a.dependencies.push(c.resolveInclude(j[1],k.filename));a.scanLine(e)})},parseTemplateText:function(){for(var a,b=this.templateText,c=this.regex,d=c.exec(b),e=[];d;)a=d.index,0!==a&&(e.push(b.substring(0,a)),b=b.slice(a)),e.push(d[0]),b=b.slice(d[0].length),d=c.exec(b);return b&&e.push(b),e},scanLine:function(a){function b(){c.truncate?(a=a.replace(/^(?:\r\n|\r|\n)/,""),c.truncate=!1):c.opts.rmWhitespace&&(a=a.replace(/^\n/,"")),a&&(a=a.replace(/\\/g,"\\\\"),a=a.replace(/\n/g,"\\n"),a=a.replace(/\r/g,"\\r"),a=a.replace(/"/g,'\\"'),c.source+='    ; __append("'+a+'")\n')}var c=this,d=this.opts.delimiter,e=0;switch(e=a.split("\n").length-1,a){case"<"+d:case"<"+d+"_":this.mode=l.modes.EVAL;break;case"<"+d+"=":this.mode=l.modes.ESCAPED;break;case"<"+d+"-":this.mode=l.modes.RAW;break;case"<"+d+"#":this.mode=l.modes.COMMENT;break;case"<"+d+d:this.mode=l.modes.LITERAL,this.source+='    ; __append("'+a.replace("<"+d+d,"<"+d)+'")\n';break;case d+d+">":this.mode=l.modes.LITERAL,this.source+='    ; __append("'+a.replace(d+d+">",d+">")+'")\n';break;case d+">":case"-"+d+">":case"_"+d+">":this.mode==l.modes.LITERAL&&b(),this.mode=null,this.truncate=0===a.indexOf("-")||0===a.indexOf("_");break;default:if(this.mode){switch(this.mode){case l.modes.EVAL:case l.modes.ESCAPED:case l.modes.RAW:a.lastIndexOf("//")>a.lastIndexOf("\n")&&(a+="\n")}switch(this.mode){case l.modes.EVAL:this.source+="    ; "+a+"\n";break;case l.modes.ESCAPED:this.source+="    ; __append(escapeFn("+k(a)+"))\n";break;case l.modes.RAW:this.source+="    ; __append("+k(a)+")\n";break;case l.modes.COMMENT:break;case l.modes.LITERAL:b()}}else b()}c.opts.compileDebug&&e&&(this.currentLine+=e,this.source+="    ; __line = "+this.currentLine+"\n")}},c.escapeXML=o.escapeXML,c.__express=c.renderFile,a.extensions&&(a.extensions[".ejs"]=function(a,b){var d=b||a.filename,e={filename:d,client:!0},f=g(d).toString(),h=c.compile(f,e);a._compile("module.exports = "+h.toString()+";",d)}),c.VERSION=q,c.name="ejs","undefined"!=typeof window&&(window.ejs=c)},{"../package.json":6,"./utils":2,fs:3,path:4}],2:[function(a,b,c){"use strict";function d(a){return f[a]||a}var e=/[|\\{}()[\]^$+*?.]/g;c.escapeRegExpChars=function(a){return a?String(a).replace(e,"\\$&"):""};var f={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},g=/[&<>\'"]/g;c.escapeXML=function(a){return void 0==a?"":String(a).replace(g,d)},c.escapeXML.toString=function(){return Function.prototype.toString.call(this)+';\nvar _ENCODE_HTML_RULES = {\n      "&": "&amp;"\n    , "<": "&lt;"\n    , ">": "&gt;"\n    , \'"\': "&#34;"\n    , "\'": "&#39;"\n    }\n  , _MATCH_HTML = /[&<>\'"]/g;\nfunction encode_char(c) {\n  return _ENCODE_HTML_RULES[c] || c;\n};\n'},c.shallowCopy=function(a,b){b=b||{};for(var c in b)a[c]=b[c];return a},c.shallowCopyFromList=function(a,b,c){for(var d=0;d<c.length;d++){var e=c[d];void 0!==b[e]&&(a[e]=b[e])}return a},c.cache={_data:{},set:function(a,b){this._data[a]=b},get:function(a){return this._data[a]},reset:function(){this._data={}}}},{}],3:[function(a,b,c){},{}],4:[function(a,b,c){(function(a){function b(a,b){for(var c=0,d=a.length-1;d>=0;d--){var e=a[d];"."===e?a.splice(d,1):".."===e?(a.splice(d,1),c++):c&&(a.splice(d,1),c--)}if(b)for(;c--;c)a.unshift("..");return a}function d(a,b){if(a.filter)return a.filter(b);for(var c=[],d=0;d<a.length;d++)b(a[d],d,a)&&c.push(a[d]);return c}var e=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,f=function(a){return e.exec(a).slice(1)};c.resolve=function(){for(var c="",e=!1,f=arguments.length-1;f>=-1&&!e;f--){var g=f>=0?arguments[f]:a.cwd();if("string"!=typeof g)throw new TypeError("Arguments to path.resolve must be strings");g&&(c=g+"/"+c,e="/"===g.charAt(0))}return c=b(d(c.split("/"),function(a){return!!a}),!e).join("/"),(e?"/":"")+c||"."},c.normalize=function(a){var e=c.isAbsolute(a),f="/"===g(a,-1);return a=b(d(a.split("/"),function(a){return!!a}),!e).join("/"),a||e||(a="."),a&&f&&(a+="/"),(e?"/":"")+a},c.isAbsolute=function(a){return"/"===a.charAt(0)},c.join=function(){var a=Array.prototype.slice.call(arguments,0);return c.normalize(d(a,function(a,b){if("string"!=typeof a)throw new TypeError("Arguments to path.join must be strings");return a}).join("/"))},c.relative=function(a,b){function d(a){for(var b=0;b<a.length&&""===a[b];b++);for(var c=a.length-1;c>=0&&""===a[c];c--);return b>c?[]:a.slice(b,c-b+1)}a=c.resolve(a).substr(1),b=c.resolve(b).substr(1);for(var e=d(a.split("/")),f=d(b.split("/")),g=Math.min(e.length,f.length),h=g,i=0;i<g;i++)if(e[i]!==f[i]){h=i;break}for(var j=[],i=h;i<e.length;i++)j.push("..");return j=j.concat(f.slice(h)),j.join("/")},c.sep="/",c.delimiter=":",c.dirname=function(a){var b=f(a),c=b[0],d=b[1];return c||d?(d&&(d=d.substr(0,d.length-1)),c+d):"."},c.basename=function(a,b){var c=f(a)[2];return b&&c.substr(-1*b.length)===b&&(c=c.substr(0,c.length-b.length)),c},c.extname=function(a){return f(a)[3]};var g="b"==="ab".substr(-1)?function(a,b,c){return a.substr(b,c)}:function(a,b,c){return b<0&&(b=a.length+b),a.substr(b,c)}}).call(this,a("_process"))},{_process:5}],5:[function(a,b,c){function d(){throw new Error("setTimeout has not been defined")}function e(){throw new Error("clearTimeout has not been defined")}function f(a){if(l===setTimeout)return setTimeout(a,0);if((l===d||!l)&&setTimeout)return l=setTimeout,setTimeout(a,0);try{return l(a,0)}catch(b){try{return l.call(null,a,0)}catch(b){return l.call(this,a,0)}}}function g(a){if(m===clearTimeout)return clearTimeout(a);if((m===e||!m)&&clearTimeout)return m=clearTimeout,clearTimeout(a);try{return m(a)}catch(b){try{return m.call(null,a)}catch(b){return m.call(this,a)}}}function h(){q&&o&&(q=!1,o.length?p=o.concat(p):r=-1,p.length&&i())}function i(){if(!q){var a=f(h);q=!0;for(var b=p.length;b;){for(o=p,p=[];++r<b;)o&&o[r].run();r=-1,b=p.length}o=null,q=!1,g(a)}}function j(a,b){this.fun=a,this.array=b}function k(){}var l,m,n=b.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:d}catch(a){l=d}try{m="function"==typeof clearTimeout?clearTimeout:e}catch(a){m=e}}();var o,p=[],q=!1,r=-1;n.nextTick=function(a){var b=new Array(arguments.length-1);if(arguments.length>1)for(var c=1;c<arguments.length;c++)b[c-1]=arguments[c];p.push(new j(a,b)),1!==p.length||q||f(i)},j.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=k,n.addListener=k,n.once=k,n.off=k,n.removeListener=k,n.removeAllListeners=k,n.emit=k,n.binding=function(a){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(a){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},{}],6:[function(a,b,c){b.exports={name:"ejs",description:"Embedded JavaScript templates",keywords:["template","engine","ejs"],version:"2.5.6",author:"Matthew Eernisse <mde@fleegix.org> (http://fleegix.org)",contributors:["Timothy Gu <timothygu99@gmail.com> (https://timothygu.github.io)"],license:"Apache-2.0",main:"./lib/ejs.js",repository:{type:"git",url:"git://github.com/mde/ejs.git"},bugs:"https://github.com/mde/ejs/issues",homepage:"https://github.com/mde/ejs",dependencies:{},devDependencies:{browserify:"^13.0.1",eslint:"^3.0.0","git-directory-deploy":"^1.5.1",istanbul:"~0.4.3",jake:"^8.0.0",jsdoc:"^3.4.0","lru-cache":"^4.0.1",mocha:"^3.0.2","uglify-js":"^2.6.2"},engines:{node:">=0.10.0"},scripts:{test:"mocha",lint:'eslint "**/*.js" Jakefile',coverage:"istanbul cover node_modules/mocha/bin/_mocha",doc:"jake doc",devdoc:"jake doc[dev]"}}},{}]},{},[1])(1)}())}(),function(a,b){var c=injector.get("$rootScope"),d=injector.get("transferredSharedDataService"),e=injector.get("modelDataService"),f=injector.get("socketService"),g=injector.get("routeProvider"),h=injector.get("eventTypeProvider"),i=injector.get("windowDisplayService"),j=injector.get("windowManagerService"),k=injector.get("hotkeys"),l=(injector.get("armyService"),injector.get("villageService"),injector.get("mapService"),injector.get("$filter"));define("two/eventQueue",function(){var a={},b={};return b.bind=function(b,c){a.hasOwnProperty(b)||(a[b]=[]),a[b].push(c)},b.trigger=function(b,c){a.hasOwnProperty(b)&&a[b].forEach(function(a){a.apply(this,c)})},b}),define("two/utils",["helper/time"],function(a){var b={};return b.randomSeconds=function(a){a=parseInt(a,10);var b=a+a/2,c=a-a/2;return Math.round(Math.random()*(b-c)+c)},b.time2seconds=function(a){return a=a.split(":"),a[0]=60*parseInt(a[0],10)*60,a[1]=60*parseInt(a[1],10),a[2]=parseInt(a[2],10),a.reduce(function(a,b){return a+b})},b.emitNotif=function(a,b){var d="success"===a?h.MESSAGE_SUCCESS:h.MESSAGE_ERROR;c.$broadcast(d,{message:b})},b.genVillageLabel=function(a){return a.name+" ("+a.x+"|"+a.y+")"},b.isValidCoords=function(a){return/\s*\d{2,3}\|\d{2,3}\s*/.test(a)},b.isValidDateTime=function(a){return/^\s*([01][0-9]|2[0-3]):[0-5]\d:[0-5]\d(:\d{1,3})? (0[1-9]|[12][0-9]|3[0-1])\/(0[1-9]|1[0-2])\/\d{4}\s*$/.test(a)},b.fixDate=function(a){var b=a.split(" "),c=b[0],d=b[1].split("/");return c+" "+d[1]+"/"+d[0]+"/"+d[2]},b.guid=function(){return Math.floor(16777216*Math.random()).toString(16)},b.matchesElem=function(a,b){return!!$(a).parents(b).length},b.getTimeFromString=function(a,b){var c=a.trim().split(" "),d=c[0].split(":"),e=c[1].split("/"),f=d[0],g=d[1],h=d[2],i=d[3]||null,j=parseInt(e[0],10)-1,k=e[1],l=e[2],e=new Date(l,j,k,f,g,h,i);return e.getTime()+(b||0)},b.formatDate=function(a,b){return l("readableDateFilter")(a,null,c.GAME_TIMEZONE,c.GAME_TIME_OFFSET,b||"HH:mm:ss dd/MM/yyyy")},b.getTimeOffset=function(){return 1e3*a.gameDate().getTimezoneOffset()*60+c.GAME_TIME_OFFSET},b.xhrGet=function(a,b,c){if(!a)return!1;c=c||"text",b=b||function(){};var d;d=new XMLHttpRequest,d.open("GET",a,!0),d.responseType=c,d.addEventListener("load",function(){b(d.response)},!1),d.send()},b}),define("two/locale",["conf/locale","i18n"],function(a,b){function c(a,b,c){if(!d.hasOwnProperty(a))return console.error("Language for module "+a+" not created");var e=Array.from(arguments).slice(1),g=f[a];return d[a][g].apply(this,e)}var d={},e={},f={},g=a.LANGUAGE.split("_")[0],h=function(a){for(var b in a)return b};return c.create=function(a,c,i){if(d.hasOwnProperty(a))return!1;d[a]={};var j=c.hasOwnProperty(g),k=c.hasOwnProperty(i);e[a]=k?i:h(c),f[a]=j?g:e[a];for(var l in c)d[a][l]=b.create({values:c[l]})},c.change=function(a,b){d[a].hasOwnProperty(b)?f[a]=b:(console.error("Language "+b+" of module "+a+" not created. Selection default ("+e[a]+")"),f[a]=e[a])},c.current=function(a){return f[a]},c.eachLang=function(a,b){var c=d[a];for(var e in c)b(e,c[e]("langName"))},c}),define("two/ready",["conf/gameStates"],function(a){var b=function(f,g){g=g||["map"];var i=function(a){g=g.filter(function(b){return b!==a}),g.length||f()},j={map:function(){if(d.getSharedData("MapController").isInitialized)return i("map");c.$on(h.MAP_INITIALIZED,function(){i("map")})},tribe_relations:function(){var a=e.getSelectedCharacter();if(a){var b=a.getTribeRelations();if(!a.getTribeId()||b)return i("tribe_relations")}var d=c.$on(h.TRIBE_RELATION_LIST,function(){d(),i("tribe_relations")})},initial_village:function(){if(e.getGameState().getGameState(a.INITIAL_VILLAGE_READY))return i("initial_village");c.$on(h.GAME_STATE_INITIAL_VILLAGE_READY,function(){i("initial_village")})},all_villages_ready:function(){if(e.getGameState().getGameState(a.ALL_VILLAGES_READY))return i("all_villages_ready");c.$on(h.GAME_STATE_ALL_VILLAGES_READY,function(){i("all_villages_ready")})}};if(!d.getSharedData("MapController"))return setTimeout(function(){b(f,g)},100);g.forEach(function(a){j[a]()})};return b}),require(["two/ready","Lockr","ejs"],function(a,b,d){a(function(){var a=e.getSelectedCharacter();d.delimiter="#",b.prefix=a.getId()+"_twOverflow_"+a.getWorldId()+"-",k.add("esc",function(){c.$broadcast(h.WINDOW_CLOSED,null,!0)},["INPUT","SELECT","TEXTAREA"])})}),require(["two/locale"],function(a){a.create("common",{en:{start:"Start",started:"Uruchomiony",pause:"Pauza",paused:"Wstrzymany",stop:"Zatrzymany",stopped:"Zatrzymany",status:"Status",none:"Żaden",info:"Informacje",settings:"Ustawienia",others:"Inne",village:"Wioska",villages:"Wioski",building:"Budynek",buildings:"Budynki",level:"Poziom",registers:"Rejestry",filters:"Filtry",add:"Dodaj",waiting:"Oczekujące",attack:"Atak",support:"Wsparcie",relocate:"Przeniesienie",activate:"Włącz",deactivate:"Wyłącz",units:"Jednostki",officers:"Oficerowie",origin:"Źródło",target:"Cel",save:"Zapisz",logs:"Logi",headquarter:"Ratusz",barracks:"Koszary",tavern:"Tawerna",hospital:"Szpital",preceptory:"Komturia",chapel:"Kaplica",church:"Kościół",academy:"Akademia",rally_point:"Plac",statue:"Piedestał",market:"Rynek",timber_camp:"Tartak",clay_pit:"Kopalnia gliny",iron_mine:"Huta żelaza",farm:"Farma",warehouse:"Magazyn",wall:"Mur",spear:"Pikinier",sword:"Miecznik",axe:"Topornik",archer:"Łucznik",light_cavalry:"Lekki kawalerzysta",mounted_archer:"Łucznik konny",heavy_cavalry:"Ciężki kawalerzysta",ram:"Taran",catapult:"Katapulta",doppelsoldner:"Berserker",trebuchet:"Trebusz",snob:"Szlachcic",knight:"Rycerz","no-results":"Brak wyników...",selected:"Wybrana",now:"Teraz",costs:"Koszty",duration:"Czas trwania",points:"Punkty",reset:"Resetuj",player:"Gracz",players:"Gracze",next_features:"Następne funkcje",misc:"Różne",colors:"Kolory"},pl:{start:"Start",started:"Uruchomiony",pause:"Pauza",paused:"Wstrzymany",stop:"Zatrzymany",stopped:"Zatrzymany",status:"Status",none:"Żaden",info:"Informacje",settings:"Ustawienia",others:"Inne",village:"Wioska",villages:"Wioski",building:"Budynek",buildings:"Budynki",level:"Poziom",registers:"Rejestry",filters:"Filtry",add:"Dodaj",waiting:"Oczekujące",attack:"Atak",support:"Wsparcie",relocate:"Przeniesienie",activate:"Włącz",deactivate:"Wyłącz",units:"Jednostki",officers:"Oficerowie",origin:"Źródło",target:"Cel",save:"Zapisz",logs:"Logi",headquarter:"Ratusz",barracks:"Koszary",tavern:"Tawerna",hospital:"Szpital",preceptory:"Komturia",chapel:"Kaplica",church:"Kościół",academy:"Akademia",rally_point:"Plac",statue:"Piedestał",market:"Rynek",timber_camp:"Tartak",clay_pit:"Kopalnia gliny",iron_mine:"Huta żelaza",farm:"Farma",warehouse:"Magazyn",wall:"Mur",spear:"Pikinier",sword:"Miecznik",axe:"Topornik",archer:"Łucznik",light_cavalry:"Lekki kawalerzysta",mounted_archer:"Łucznik konny",heavy_cavalry:"Ciężki kawalerzysta",ram:"Taran",catapult:"Katapulta",doppelsoldner:"Berserker",trebuchet:"Trebusz",snob:"Szlachcic",knight:"Rycerz","no-results":"Brak wyników...",selected:"Wybrana",now:"Teraz",costs:"Koszty",duration:"Czas trwania",points:"Punkty",reset:"Resetuj",player:"Gracz",players:"Gracze",next_features:"Następne funkcje",misc:"Różne",colors:"Kolory"}},"en")}),define("two/checkmate",["two/locale","two/eventQueue","two/ready"],function(a,b,c){var d=!1,e={};return e.version="1.0.0",e.init=function(){a.create("checkmate",{en:{title:"Sędzia",achievements:"Osiągnięcia",points:"Punkty",logs:"Logi",rank:"Ranking",name:"Gracz",id:"Id",villages:"Wiosek",pointspervillage:"Punkty/Wioska",bashpointstotal:"Bojowe",bashpointsoff:"Ofensywne",bashpointsdeff:"Defensywne",victorypoints:"Zwycięstwa","logs.noPlayers":"Brak graczy",wayofsword:"Droga Tarczy",wayofshield:"Droga Miecza",stolengoods:"Zrabowane Towary",butcher:"Rzeźnik",vandal:"Wandal",shellcracker:"Dziadek do orzechów",gravedigger:"Grabarz",actofvalor:"Akt odwagi",wayofthesoldier:"Ścieżka żołnierza",wayoftherider:"Ścieżka jeźdzcy",hammersandnails:"Młotek i gwoździe",wayofeducation:"Znaczenie edukacji",myownworstenemy:"Mój własny wróg",harvester:"Żniwiarz",brotherinarms:"Braterstwo krwi",collaboration:"Wspólna gra",looterofday:"Grabieżca dnia",assaulterofday:"Najeźdzca dnia",defenderofday:"Obrońca dnia",butcherofday:"Rzeźnik dnia",thiefofday:"Złodziej dnia",conquestofday:"Podbój dnia",biggerbetter:"Większy, lepszy",status:"Status",paused:"Zastopowany","events.selectedPlayer":"Wybrany gracz: ","events.lastPlayer":"Ostatni gracz: ",none:"Brak",clear:"Wyczyść wpisy",start:"Pobierz dane","logs.clear":"Wyczyść logi","events.nothingYet":"Brak wpisów"},pl:{title:"Sędzia",achievements:"Osiągnięcia",points:"Punkty",logs:"Logi",rank:"Ranking",name:"Gracz",id:"Id",villages:"Wiosek",pointspervillage:"Punkty/Wioska",bashpointstotal:"Bojowe",bashpointsoff:"Ofensywne",bashpointsdeff:"Defensywne",victorypoints:"Zwycięstwa","logs.noPlayers":"Brak graczy",wayofsword:"Droga Tarczy",wayofshield:"Droga Miecza",stolengoods:"Zrabowane Towary",butcher:"Rzeźnik",vandal:"Wandal",shellcracker:"Dziadek do orzechów",gravedigger:"Grabarz",actofvalor:"Akt odwagi",wayofthesoldier:"Ścieżka żołnierza",wayoftherider:"Ścieżka jeźdzcy",hammersandnails:"Młotek i gwoździe",wayofeducation:"Znaczenie edukacji",myownworstenemy:"Mój własny wróg",harvester:"Żniwiarz",brotherinarms:"Braterstwo krwi",collaboration:"Wspólna gra",looterofday:"Grabieżca dnia",assaulterofday:"Najeźdzca dnia",defenderofday:"Obrońca dnia",butcherofday:"Rzeźnik dnia",thiefofday:"Złodziej dnia",conquestofday:"Podbój dnia",biggerbetter:"Większy, lepszy",status:"Status",paused:"Zastopowany","events.selectedPlayer":"Wybrany gracz: ","events.lastPlayer":"Ostatni gracz: ",none:"Brak",clear:"Wyczyść wpisy",start:"Pobierz dane","logs.clear":"Wyczyść logi","events.nothingYet":"Brak wpisów"}},"pl"),e.initialized=!0},e.start1=function(a){d=!0,b.trigger("ActivityTool/start1",[a])},e.stop1=function(){d=!1,b.trigger("ActivityTool/stop1")},e.start2=function(a){d=!0,b.trigger("ActivityTool/start2",[a])},e.stop2=function(){d=!1,b.trigger("ActivityTool/stop2")},e.isInitialized=function(){return!1},e.isRunning=function(){return d},e}),require(["two/ready","two/checkmate","two/checkmate/ui"],function(a,b){if(b.initialized)return!1;a(function(){b.init(),b.interface()})}),define("two/checkmate/ui",["two/checkmate","two/locale","two/ui","two/FrontButton","ejs","Lockr","two/eventQueue","two/utils"],function(a,b,c,d,e,f,g,h){var j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A=(injector.get("modelDataService"),injector.get("socketService"),injector.get("routeProvider"),function(){z.on("click",function(a){O()}),o.on("click",function(a){P()}),p.on("click",function(a){Q()}),m.on("click",function(b){a.isRunning()?(a.stop1(),a.stop2()):(a.start1(),checkPlayers())}),n.on("click",function(b){a.isRunning()?(a.stop1(),a.stop2()):(a.start2(),checkAchievements())}),g.bind("ActivityTool/start1",function(){m.html(b("common","stop")),m.removeClass("btn-green").addClass("btn-red"),k.$elem.removeClass("btn-green").addClass("btn-red"),h.emitNotif("success",b("checkmate","general.started"))}),g.bind("ActivityTool/stop1",function(){m.html(b("common","start")),m.removeClass("btn-red").addClass("btn-green"),k.$elem.removeClass("btn-red").addClass("btn-green"),h.emitNotif("success",b("checkmate","general.stopped"))}),g.bind("ActivityTool/start2",function(){n.html(b("common","stop")),n.removeClass("btn-green").addClass("btn-red"),k.$elem.removeClass("btn-green").addClass("btn-red"),h.emitNotif("success",b("checkmate","general.started"))}),g.bind("ActivityTool/stop2",function(){n.html(b("common","start")),n.removeClass("btn-red").addClass("btn-green"),k.$elem.removeClass("btn-red").addClass("btn-green"),h.emitNotif("success",b("checkmate","general.stopped"))}),g.bind("ActivityTool/jobStartedX",E),g.bind("ActivityTool/jobStartedY",C),g.bind("ActivityTool/jobStartedZ",D),g.bind("ActivityTool/clearLogsX",F),g.bind("ActivityTool/clearLogsY",G),g.bind("ActivityTool/clearLogsZ",H)}),B=function(){return r=f.get("checkmate-log",[],!0),t=f.get("points-log",[],!0),v=f.get("achievements-log",[],!0),j=new c("ActivityTool",{activeTab:"presets",
template:'<div class="win-content message-list-wrapper searchable-list ng-scope"><header class="win-head"><h2><#= locale("checkmate", "title") #> <span class="small">v<#= version #></span></h2><ul class="list-btn"><li><a href="#" class="twOverflow-close size-34x34 btn-red icon-26x26-close"></a></li></ul></header><div class="tabs tabs-bg"><div class="tabs-three-col"><div class="tab" tab="points"><div class="tab-inner"><div><a href="#" class="btn-icon btn-orange"><#= locale("checkmate", "points") #></a></div></div></div><div class="tab" tab="achievements"><div class="tab-inner"><div><a href="#" class="btn-icon btn-orange"><#= locale("checkmate", "achievements") #></a></div></div></div><div class="tab" tab="logs"><div class="tab-inner"><div><a href="#" class="btn-icon btn-orange"><#= locale("checkmate", "logs") #></a></div></div></div></div></div><div class="win-main"><div class="box-paper footer has-footer-upper twOverflow-content-points"><table class="tbl-border-light tbl-striped header-center"><colgroup><col width="5%"><col width="20%"><col width="10%"><col width="10%"><col><col width="10%"><col><col width="10%"><col width="10%"><col width="5%"></colgroup><thead><tr><th><#= locale("checkmate", "rank") #></th><th><#= locale("checkmate", "name") #></th><th><#= locale("checkmate", "id") #></th><th><#= locale("checkmate", "villages") #></th><th><#= locale("checkmate", "points") #></th><th><#= locale("checkmate", "pointspervillage") #></th><th><#= locale("checkmate", "bashpointstotal") #></th><th><#= locale("checkmate", "bashpointsoff") #></th><th><#= locale("checkmate", "bashpointsdeff") #></th><th><#= locale("checkmate", "victorypoints") #></th></tr></thead><tbody class="pointsLog"><tr class="noPlayers1"><td colspan="10"><#= locale("checkmate", "logs.noPlayers") #></td></tr></tbody></table></div><div class="box-paper footer has-footer-upper twOverflow-content-achievements"><table class="tbl-border-light tbl-striped header-center"><colgroup><col width="18%"><col width="8%"><col><col><col><col><col><col><col><col><col><col><col><col><col><col><col><col><col><col><col><col><col><col><col width="5%"></colgroup><thead><tr><th><#= locale("checkmate", "name") #></th><th><#= locale("checkmate", "id") #></th><th><#= locale("checkmate", "wayofsword") #></th><th><#= locale("checkmate", "wayofshield") #></th><th><#= locale("checkmate", "stolengoods") #></th><th><#= locale("checkmate", "butcher") #></th><th><#= locale("checkmate", "vandal") #></th><th><#= locale("checkmate", "shellcracker") #></th><th><#= locale("checkmate", "gravedigger") #></th><th><#= locale("checkmate", "actofvalor") #></th><th><#= locale("checkmate", "wayofthesoldier") #></th><th><#= locale("checkmate", "wayoftherider") #></th><th><#= locale("checkmate", "hammersandnails") #></th><th><#= locale("checkmate", "wayofeducation") #></th><th><#= locale("checkmate", "myownworstenemy") #></th><th><#= locale("checkmate", "harvester") #></th><th><#= locale("checkmate", "brotherinarms") #></th><th><#= locale("checkmate", "collaboration") #></th><th><#= locale("checkmate", "looterofday") #></th><th><#= locale("checkmate", "assaulterofday") #></th><th><#= locale("checkmate", "defenderofday") #></th><th><#= locale("checkmate", "butcherofday") #></th><th><#= locale("checkmate", "thiefofday") #></th><th><#= locale("checkmate", "conquestofday") #></th><th><#= locale("checkmate", "biggerbetter") #></th></tr></thead><tbody class="achievementsLog"><tr class="noPlayers2"><td colspan="25"><#= locale("checkmate", "logs.noPlayers") #></td></tr></tbody></table></div><div class="box-paper footer has-footer-upper twOverflow-content-logs"><div class="screen-tribe-news rich-text"><h5 class="twx-section collapse"><#= locale("checkmate", "status") #></h5><table class="tbl-border-light tbl-news tbl-big-header"><colgroup><col width="135px"><col width="*"></colgroup><tbody><tr class="list-item"><td class="status" colspan="2" class="cell-center"><#= locale("checkmate", "paused") #></td></tr><tr class="reduced"><td><#= locale("checkmate", "events.selectedPlayer") #></td><td class="selected"></td></tr><tr class="reduced"><td><#= locale("checkmate", "events.lastPlayer") #></td><td class="last"><#= locale("checkmate", "none") #></td></tr></tbody></table><h5 class="twx-section collapse"><#= locale("checkmate", "logs") #></h5><table class="tbl-border-light tbl-news tbl-big-header"><colgroup><col width="76px"><col></colgroup><tbody class="checkmateLog"><tr class="noPlayers"><td colspan="2"><div><span><#= locale("checkmate", "logs.noPlayers") #></span></div></td></tr></tbody></table></div></div></div><footer class="win-foot"><ul class="list-btn list-center buttons"><li class="twOverflow-button-points"><a class="btn-orange btn-border clear1"><#= locale("checkmate", "clear") #></a><a class="btn-green btn-border switch1"><#= locale("checkmate", "start") #></a></li><li class="twOverflow-button-achievements"><a class="btn-orange btn-border clear2"><#= locale("checkmate", "clear") #></a><a class="btn-green btn-border switch2"><#= locale("checkmate", "start") #></a></li><li class="twOverflow-button-logs"><a class="btn-orange btn-border clearLogs"><#= locale("checkmate", "logs.clear") #></a></li></ul></footer></div>',css:'#ActivityTool input[type="text"],#ActivityTool input[type="number"],#ActivityTool select{color:#000;min-width:70%}#ActivityTool .addForm input{width:100%}#ActivityTool .addForm th{text-align:center}#ActivityTool .addForm td{text-align:center}#ActivityTool .addForm span{height:26px;line-height:26px;padding:0 10px}#ActivityTool .checkmateLog td{text-align:center}#ActivityTool .checkmateLog .name:hover{color:#fff;text-shadow:0 1px 0 #000}#ActivityTool table.header-center th{text-align:center}#ActivityTool .pointsLog td{text-align:center}#ActivityTool .pointsLog .name:hover{color:#fff;text-shadow:0 1px 0 #000}#ActivityTool .achievementsLog td{text-align:center}#ActivityTool .achievementsLog .name:hover{color:#fff;text-shadow:0 1px 0 #000}#ActivityTool .noPlayers td{height:26px;text-align:center}#ActivityTool .noPlayers1 td{height:26px;text-align:center}#ActivityTool .noPlayers2 td{height:26px;text-align:center}#ActivityTool .force-26to20{transform:scale(.8);width:20px;height:20px}',replaces:{locale:b,version:a.version}}),k=new d(b("checkmate","title"),{classHover:!1,classBlur:!1,onClick:function(){j.openWindow()}}),l=$(j.$window),z=l.find(".clearLogs"),m=l.find(".switch1"),n=l.find(".switch2"),o=l.find(".clear1"),p=l.find(".clear2"),q=l.find(".checkmateLog"),s=l.find(".pointsLog"),u=l.find(".achievementsLog"),w=l.find(".noPlayers"),x=l.find(".noPlayers1"),y=l.find(".noPlayers2"),I(),J(),K(),A(),j},C=function(a,c,d,f,g,k,l,m,n,o){x.hide();var p=document.createElement("tr");p.innerHTML=e.render('<td><#= rank #></td><td class="name"><#= name #></td><td><#= id #></td><td><#= villages #></td><td><#= points #></td><td><#= pointspervillage #></td><td><#= bashpointstotal #></td><td><#= bashpointsoff #></td><td><#= bashpointsdeff #></td><td><#= victorypoints #></td>',{locale:b,rank:a,name:h.genPlayerLabel(c),id:d,villages:f,points:g,pointspervillage:k,bashpointstotal:l,bashpointsoff:m,bashpointsdeff:n,victorypoints:o}),p.querySelector(".name").addEventListener("click",function(){i.openPlayerInfo(c.id)}),s.prepend(p),j.recalcScrollbar()},D=function(a,c,d,f,g,k,l,m,n,o,p,q,r,s,t,v){y.hide();var w=document.createElement("tr");w.innerHTML=e.render('<td class="name"><#= name #></td><td><#= id #></td><td><#= wayofsword #></td><td><#= wayofshield #></td><td><#= stolengoods #></td><td><#= butcher #></td><td><#= vandal #></td><td><#= shellcracker #></td><td><#= gravedigger #></td><td><#= actofvalor #></td><td><#= wayofthesoldier #></td><td><#= wayoftherider #></td><td><#= hammersandnails #></td><td><#= wayofeducation #></td><td><#= myownworstenemy #></td><td><#= harvester #></td>',{locale:b,name:h.genPlayerLabel(a),id:c,wayofsword:d,wayofshield:f,stolengoods:g,butcher:k,vandal:l,shellcracker:m,gravedigger:n,actofvalor:o,wayofthesoldier:p,wayoftherider:q,hammersandnails:r,wayofeducation:s,myownworstenemy:t,harvester:v}),w.querySelector(".name").addEventListener("click",function(){i.openPlayerInfo(a.id)}),u.prepend(w),j.recalcScrollbar()},E=function(a,c,d,f,g,k,l,m,n,o,p){y.hide();var r=document.createElement("tr");r.innerHTML=e.render('<td class="name"><#= name #></td><td><#= id #></td><td><#= wayofsword #></td><td><#= wayofshield #></td><td><#= stolengoods #></td><td><#= butcher #></td><td><#= vandal #></td><td><#= shellcracker #></td><td><#= gravedigger #></td><td><#= actofvalor #></td><td><#= wayofthesoldier #></td><td><#= wayoftherider #></td><td><#= hammersandnails #></td><td><#= wayofeducation #></td><td><#= myownworstenemy #></td><td><#= harvester #></td>',{locale:b,name:h.genPlayerLabel(a),id:c,brotherinarms:d,collaboration:f,looterofday:g,assaulterofday:k,defenderofday:l,butcherofday:m,thiefofday:n,conquestofday:o,biggerbetter:p}),r.querySelector(".name").addEventListener("click",function(){i.openPlayerInfo(a.id)}),q.prepend(r),j.recalcScrollbar()},F=function(){q.find("tr:not(.noPlayers)").remove(),w.css("display","")},G=function(){s.find("tr:not(.noPlayers1)").remove(),x.css("display","")},H=function(){u.find("tr:not(.noPlayers2)").remove(),y.css("display","")},I=function(){L().forEach(function(a){E.apply(this,a)})},J=function(){M().forEach(function(a){C.apply(this,a)})},K=function(){N().forEach(function(a){D.apply(this,a)})},L=function(){return r},M=function(){return t},N=function(){return v},O=function(){r=[],f.set("checkmate-log",r),g.trigger("ActivityTool/clearLogsX")},P=function(){t=[],f.set("points-log",t),g.trigger("ActivityTool/clearLogsY")},Q=function(){v=[],f.set("achievements-log",v),g.trigger("ActivityTool/clearLogsZ")};a.interface=function(){a.interface=B()}}),define("two/ui",["two/utils","queues/EventQueue","helper/dom","ejs"],function(b,d,e,f){function g(a,b){var d=this;return k.push(d),d.windowId=a,d.activeTab=b.activeTab,d.settings=b,m(a,b.css),d.buildWindow(),d.bindTabs(),d.setCollapse(),d.setTooltips(),d.setCheckboxes(),d.setSelects(),d.$window.querySelector(".twOverflow-close").addEventListener("click",function(){d.closeWindow()}),c.$on(h.WINDOW_CLOSED,function(b,c,e){(e||c===a)&&d.closeWindow()}),d}var i=!1,k=[],l=function(){k.forEach(function(a){a.closeWindow()})},m=function(a,b){var c=document.createElement("style");c.type="text/css",c.id="twOverflow-style-"+a,c.innerHTML=b,document.querySelector("head").appendChild(c)},n=function(d){var e=!1,f=document.createElement("span"),g=document.createElement("span"),i=document.createElement("span"),j=document.createElement("span"),k=function(a){var c=a.srcElement||a.target;b.matchesElem(c,".custom-select")||l()},l=function(){c.$broadcast(h.SELECT_HIDE,"custom-select"),$(a).off("click",k),$(".win-main").off("mousewheel",l),e=!1,o()},m=function(a,b){g.innerHTML=a.name,f.dataset.name=a.name,f.dataset.value=a.value,$(f).trigger("selectSelected"),l()},n=function(){i.classList.remove("icon-26x26-arrow-down"),i.classList.add("icon-26x26-arrow-up")},o=function(){i.classList.remove("icon-26x26-arrow-up"),i.classList.add("icon-26x26-arrow-down")};d.querySelectorAll("option").forEach(function(a){var b=document.createElement("span");b.dataset.name=a.innerText,b.dataset.value=a.value,j.appendChild(b),a.hasAttribute("selected")&&(g.innerHTML=a.innerText,f.dataset.name=a.innerText,f.dataset.value=a.value)});for(var p in d.dataset)f.dataset[p]=d.dataset[p];f.className="custom-select "+d.className,i.className="custom-select-button icon-26x26-arrow-down",g.className="custom-select-handler",j.className="custom-select-data",f.appendChild(g),f.appendChild(i),f.appendChild(j),f.addEventListener("click",function(){if(e)return l();var b=j.querySelectorAll("span"),d=[],i={};b.forEach(function(a){var b={name:a.dataset.name,value:a.dataset.value};a.dataset.icon&&(b.leftIcon=isNaN(a.dataset.icon)?a.dataset.icon:parseInt(a.dataset.icon,10)),a.dataset.name===g.innerHTML&&(i=b),d.push(b)}),c.$broadcast(h.SELECT_SHOW,"custom-select",d,i,m,f,!0),e=!0,n(),$(".win-main").on("mousewheel",l),$(a).on("click",k)}),d.replaceWith(f)};return g.prototype.buildWindow=function(){this.$wrapper=$("#wrapper"),this.$window=document.createElement("section"),this.$window.id=this.windowId,this.$window.className="twOverflow-window twx-window screen left",this.$window.style.visibility="hidden",this.$window.innerHTML=f.render(this.settings.template,this.settings.replaces),this.$wrapper.append(this.$window),this.$scrollbar=jsScrollbar(this.$window.querySelector(".win-main"))},g.prototype.openWindow=function(){j.closeAll(),l(),this.$window.style.visibility="visible",this.$wrapper.addClass("window-open"),this.resizeWindowFrame()},g.prototype.resizeWindowFrame=function(){d.trigger(d.types.RESIZE,{instant:!0,right:!0})},g.prototype.closeWindow=function(){"visible"===this.$window.style.visibility&&(this.settings.onClose&&this.settings.onClose(),this.$window.style.visibility="hidden",this.$wrapper.removeClass("window-open"),this.resizeWindowFrame())},g.prototype.toggleWindow=function(a){this.$window.style.visibility=a,this.$wrapper.toggleClass("window-open"),this.resizeWindowFrame()},g.prototype.tabsState=function(a,b){var c=this;if(a===b)return!1;c.$tabs.forEach(function(d){var e=d.getAttribute("tab");if(e!==a&&e!==b)return!1;e===a?c.disableTab(e,d):e===b&&c.enableTab(e,d)})},g.prototype.bindTabs=function(){var a=this;a.$tabs=a.$window.querySelectorAll(".tab"),a.$tabs.forEach(function(b){var c=b.getAttribute("tab");b.addEventListener("click",function(){a.tabsState(a.activeTab,c),a.activeTab=c,a.settings.onTabClick&&a.settings.onTabClick(c)}),a.activeTab===c?a.enableTab(c,b):a.disableTab(c,b),a.recalcScrollbar()})},g.prototype.enableTab=function(a,b){var c=this.$window.querySelector(".twOverflow-content-"+a),d=this.$window.querySelectorAll(".twOverflow-button-"+a),e=this.$window.querySelectorAll(".twOverflow-button"),f=b.querySelector(".tab-inner > div"),g=b.querySelector("a"),h=this.$window.querySelector("footer");c.style.display="",b.classList.add("tab-active"),f.classList.add("box-border-light"),g.classList.remove("btn-icon","btn-orange"),h&&(h.style.display=d.length||e.length?"":"none",d.length&&d.forEach(function(a){a.style.display=""})),this.$scrollbar.content=c,this.recalcScrollbar()},g.prototype.disableTab=function(a,b){var c=this.$window.querySelector(".twOverflow-content-"+a),d=this.$window.querySelectorAll(".twOverflow-button-"+a),e=(this.$window.querySelectorAll(".twOverflow-button"),b.querySelector(".tab-inner > div")),f=b.querySelector("a"),g=this.$window.querySelector("footer");c.style.display="none",b.classList.remove("tab-active"),e.classList.remove("box-border-light"),f.classList.add("btn-icon","btn-orange"),g&&d.length&&d.forEach(function(a){a.style.display="none"})},g.prototype.destroy=function(){document.querySelector("#twOverflow-style-"+this.windowId).remove(),this.$window.remove()},g.prototype.setCollapse=function(){var a=this;a.$window.querySelectorAll(".twx-section.collapse").forEach(function(b){var c=!b.classList.contains("hidden-content"),d=document.createElement("span");d.className="min-max-btn";var e=document.createElement("a");e.className="btn-orange icon-26x26-"+(c?"minus":"plus"),c||(b.nextSibling.style.display="none"),d.appendChild(e),b.appendChild(d),d.addEventListener("click",function(){"none"===b.nextSibling.style.display?(b.nextSibling.style.display="",e.className=e.className.replace("plus","minus"),c=!0):(b.nextSibling.style.display="none",e.className=e.className.replace("minus","plus"),c=!1),a.recalcScrollbar()})})},g.prototype.setTooltips=function(){var a=this,b=$("#tooltip");b.find(".tooltip-content-wrapper");a.$window.querySelectorAll("[tooltip]").forEach(function(a){var b=a.getAttribute("tooltip");a.removeAttribute("tooltip"),a.addEventListener("mouseenter",function(a){c.$broadcast(h.TOOLTIP_SHOW,"twoverflow-tooltip",b,!0,a)}),a.addEventListener("mouseleave",function(){c.$broadcast(h.TOOLTIP_HIDE,"twoverflow-tooltip")})})},g.prototype.setCheckboxes=function(){this.$window.querySelectorAll("input[type=checkbox]").forEach(function(a){a.addEventListener("click",function(){$(a).parent().toggleClass("icon-26x26-checkbox-checked")})})},g.prototype.isVisible=function(a){var b="visible"===this.$window.style.visibility;return b&&a&&(b=this.activeTab===a),b},g.prototype.recalcScrollbar=function(){this.$scrollbar.recalc()},g.prototype.setSelects=function(){this.$window.querySelectorAll("select").forEach(function(a){n(a)})},g.init=function(){i=!0,m("own",'#twOverflow-leftbar{position:relative;top:0;left:0;margin-bottom:7px}#twOverflow-leftbar .button{white-space:nowrap;position:relative;top:-17px;left:0;min-width:70px;height:24px;padding:0 3px}#twOverflow-leftbar .label,#twOverflow-leftbar .quickview{margin:5px 0;font-size:12px}#twOverflow-leftbar .quickview{display:none}#wrapper.window-open #twOverflow-leftbar .button{left:720px}.twOverflow-window{visibility:hidden}.twOverflow-window h3{color:#000}.twOverflow-window p{color:#000;margin:7px 0;padding:0 40px}.twOverflow-window p span.sample{font-weight:bold;font-style:italic}.twOverflow-window p span.brazil{color:green;font-weight:bold}.twOverflow-window p .opensource{background:url(https://i.imgur.com/KFHdWXN.png);width:15px;height:15px;display:inline-block;vertical-align:-2px}.twOverflow-window input::placeholder{color:#6d563c}.twOverflow-window input[type="text"],.twOverflow-window input[type="number"],.twOverflow-window select{color:black;text-align:center}.twOverflow-window select{width:100%;padding:0 0 0 5px;font-size:14px;border:1px solid #976543;height:28px;text-decoration:none;text-align-last:center;border-radius:2px;font-weight:600;font-family:"Trebuchet MS";color:white;box-shadow:0 0 0 1px #421f09 inset,0 0 0 2px #976543 inset,0 0 0 3px #421f09 inset,0 -1px 1px 4px rgba(215,181,144,0.7) inset,0 0 1px 5px rgba(0,0,0,0.4) inset;-webkit-appearance:none;-moz-appearance:none;outline:none;background-image:url(https://i.imgur.com/SlaWRrX.png),url(https://i.imgur.com/e2qKrmX.png);background-repeat:no-repeat,repeat;background-position:293px -3px,top left;background-color:#b28e68}.twOverflow-window .custom-select{position:relative;display:inline-block}.twOverflow-window .custom-select .custom-select-button{height:21px;position:absolute;right:1px;top:1px}.twOverflow-window .custom-select .custom-select-handler{text-align:center;line-height:25px;height:25px;display:block;background:url("data:image/png;base64,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") top left #ceab84;box-shadow:inset 0 0 0 1px #533a1f,inset 0 0 0 2px #dcba94,0 0 2px rgba(0,0,0,0.6);padding:0 10px}.twOverflow-window .custom-select .custom-select-data{display:none}.twOverflow-window .center{text-align:center}.twOverflow-window .reduced{height:30px}@keyframes expand-button{100%{width:250px}}@keyframes contract-button{0%{width:250px}}.expand-button{animation:expand-button .1s forwards}.contract-button{animation:contract-button .1s forwards}.icon-26x26-preset{background-image:url(data:image/png;base64,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);margin-top:2px;margin-left:5px}')},g.isInitialized=function(){return i},g}),define("two/ui/autoComplete",["two/utils","two/locale","helper/dom","struct/MapData"],function(b,d,e,i){var j="two-autocomplete",k=!1,l=function(a){var c=a.srcElement||a.target;b.matchesElem(c,".custom-select")||n.hide()},m=function(a){n.hide(),c.$broadcast(h.SELECT_HIDE,j),c.$broadcast(h.SELECT_SELECTED,j,a)},n={};return n.hide=function(){c.$broadcast(h.SELECT_HIDE,j),$(a).off("click",l),$(".win-main").off("mousewheel",n.hide),k=!1},n.show=function(b,e,f,g){return j=f,!!b.length&&(c.$broadcast(h.SELECT_SHOW,j,b,null,m,e,!0,0,d("common","no-results")),k||(k=!0,$(".win-main").on("mousewheel",n.hide),$(a).on("click",l)),!0)},n.search=function(a,c,d,e){var h=[];if(b.isValidCoords(a)){var j=a.split("|").map(function(a){return parseInt(a,10)});return void i.loadTownDataAsync(j[0],j[1],1,1,function(a){a&&h.push({id:a.id,type:"village",name:b.genVillageLabel(a)}),c(h)})}f.emit(g.AUTOCOMPLETE,{types:d||["village","character","tribe"],string:a,amount:e||5},function(a){for(var d in a.result)a.result[d].forEach(function(a,c){a.type=d,a.leftIcon="size-34x34 icon-26x26-rte-"+d,"village"===d&&(a.name=b.genVillageLabel(a)),h.push(a)});c(h)})},n}),define("two/ui/buttonLink",["ejs"],function(a){return function(b,c,d){var e=Math.round(1e5*Math.random()),f=a.render('<a id="l<#= uid #>" class="img-link icon-20x20-<#= type #> btn btn-orange padded"><#= text #></a>',{type:b,text:c,uid:e}),g=document.createElement("div");g.innerHTML=f,g=g.firstChild;var h;switch(b){case"village":h=function(){i.openVillageInfo(d)};break;case"character":h=function(){i.openCharacterProfile(d)}}return g.addEventListener("click",h),{html:f,id:"l"+e,elem:g}}}),define("two/FrontButton",["ejs"],function(a){function b(a,b){this.options=b=angular.merge({label:a,className:"",classHover:"expand-button",classBlur:"contract-button",tooltip:!1,onClick:function(){}},b),this.buildWrapper(),this.appendButton();var d=this.$elem,e=d.find(".label"),f=d.find(".quickview");return b.classHover&&d.on("mouseenter",function(){d.addClass(b.classHover),d.removeClass(b.classBlur),e.hide(),f.show()}),b.classBlur&&d.on("mouseleave",function(){d.addClass(b.classBlur),d.removeClass(b.classHover),f.hide(),e.show()}),b.tooltip&&(d.on("mouseenter",function(a){c.$broadcast(h.TOOLTIP_SHOW,"twoverflow-tooltip",b.tooltip,!0,a)}),d.on("mouseleave",function(){c.$broadcast(h.TOOLTIP_HIDE,"twoverflow-tooltip")})),b.onClick&&this.click(b.onClick),this}return b.prototype.updateQuickview=function(a){this.$elem.find(".quickview").html(a)},b.prototype.hover=function(a){this.$elem.on("mouseenter",a)},b.prototype.click=function(a){this.$elem.on("click",a)},b.prototype.buildWrapper=function(){var a=document.getElementById("twOverflow-leftbar");a||(a=document.createElement("div"),a.id="twOverflow-leftbar",$("#toolbar-left").prepend(a)),this.$wrapper=a},b.prototype.appendButton=function(){var b=a.render('<div class="btn-border btn-green button <#= className #>"><div class="top-left"></div><div class="top-right"></div><div class="middle-top"></div><div class="middle-bottom"></div><div class="middle-left"></div><div class="middle-right"></div><div class="bottom-left"></div><div class="bottom-right"></div><div class="label"><#= label #></div><div class="quickview"></div></div>',{className:this.options.className,label:this.options.label}),c=document.createElement("div");c.innerHTML=b;var d=c.children[0];this.$wrapper.appendChild(d),this.$elem=$(d)},b.prototype.destroy=function(){this.$elem.remove()},b}),require(["two/ready","two/ui"],function(a,b){if(b.isInitialized())return!1;a(function(){b.init()})})}(this);
//# sourceMappingURL=tw2overflow.map